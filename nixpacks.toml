# nixpacks.toml - ARM64 (OCI) + Streamlit + Geo stack
# Objetivo: compilar numpy/pandas en ARM y tener librer√≠as GIS del sistema.

[phases.setup]
aptPkgs = [
  "build-essential",
  "gcc",
  "g++",
  "gfortran",
  "pkg-config",
  "cmake",

  # BLAS/LAPACK
  "libopenblas-dev",
  "liblapack-dev",

  # Geo stack
  "libgeos-dev",
  "proj-bin",
  "libproj-dev",
  "gdal-bin",
  "libgdal-dev",

  # utilidades
  "curl",
  "git",
  "wget"
]

[phases.install]
cmds = [
  "python -m venv /opt/venv",
  ". /opt/venv/bin/activate && pip install -U pip setuptools wheel",
  ". /opt/venv/bin/activate && PIP_DISABLE_PIP_VERSION_CHECK=1 PIP_NO_CACHE_DIR=1 pip install --no-binary=numpy,pandas -r requirements-coolify.txt"
]

[start]
cmd = "bash ./start.sh"
